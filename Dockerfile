FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGN1c3RvbS1ydW50aW1lLWNvbm5lY3Rvci1hcGIKZGVzY3JpcHRp\
b246IFJ1bnRpbWUgQ29ubmVjdG9yCmJpbmRhYmxlOiBUcnVlCmFzeW5jOiByZXF1aXJlZAp0YWdz\
OgogIC0gbW9iaWxlLXNlcnZpY2UKICAtIG1vYmlsZS1jbGllbnQtZW5hYmxlZAptZXRhZGF0YToK\
ICBjb25zb2xlLm9wZW5zaGlmdC5pby9pY29uQ2xhc3M6IGZhIGZhLXBsdWcKICBkaXNwbGF5TmFt\
ZTogUnVudGltZSBDb25uZWN0b3IKICBkZXBlbmRlbmNpZXM6IFtdCiAgZG9jdW1lbnRhdGlvblVy\
bDogImh0dHA6Ly9kb2NzLmFlcm9nZWFyLm9yZy9leHRlcm5hbC9hcGIvY3VzdG9tLXJ1bnRpbWUt\
Y29ubmVjdG9yLmh0bWwiCiAgcHJvdmlkZXJEaXNwbGF5TmFtZTogIlJlZCBIYXQsIEluYy4iCiAg\
c2RrLWRvY3MtYW5kcm9pZDogImh0dHBzOi8vZG9jcy5hZXJvZ2Vhci5vcmcvZXh0ZXJuYWwvYXBi\
L3J1bnRpbWUtY29ubmVjdG9yL2FuZHJvaWQuaHRtbCIKICBzZGstZG9jcy1jb3Jkb3ZhOiAiaHR0\
cHM6Ly9kb2NzLmFlcm9nZWFyLm9yZy9leHRlcm5hbC9hcGIvcnVudGltZS1jb25uZWN0b3IvY29y\
ZG92YS5odG1sIgogIHNkay1kb2NzLWlvczogImh0dHBzOi8vZG9jcy5hZXJvZ2Vhci5vcmcvZXh0\
ZXJuYWwvYXBiL3J1bnRpbWUtY29ubmVjdG9yL2lvcy5odG1sIgogIHNkay1kb2NzLXhhbWFyaW46\
ICJodHRwczovL2RvY3MuYWVyb2dlYXIub3JnL2V4dGVybmFsL2FwYi9ydW50aW1lLWNvbm5lY3Rv\
ci94YW1hcmluLmh0bWwiCiAgc2VydmljZU5hbWU6IGN1c3RvbS1ydW50aW1lLWNvbm5lY3Rvcgpw\
bGFuczoKICAtIG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBUaGlzIGRlZmF1bHQgcGxh\
biBkZXBsb3lzIGN1c3RvbS1ydW50aW1lLWNvbm5lY3Rvci1hcGIKICAgIGZyZWU6IFRydWUKICAg\
IG1ldGFkYXRhOgogICAgICBtb2JpbGVjbGllbnRfYmluZF9wYXJhbWV0ZXJzX2RhdGE6CiAgICAg\
ICAgLSAneyJuYW1lIjogIkNMSUVOVF9JRCIsICJ2YWx1ZSI6ICJtZXRhZGF0YS5uYW1lIiwgInR5\
cGUiOiAicGF0aCJ9JwogICAgcGFyYW1ldGVyczoKICAgIC0gbmFtZTogU0VSVklDRV9OQU1FCiAg\
ICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRsZTogU2VydmljZSBOYW1lCiAgICAgIHJlcXVpcmVk\
OiBUcnVlCiAgICAtIG5hbWU6IFNFUlZJQ0VfVVJJCiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0\
aXRsZTogU2VydmljZSBVUkwKICAgICAgcmVxdWlyZWQ6IFRydWUKICAgIC0gbmFtZTogU0VSVklD\
RV9DT05GSUcKICAgICAgZGVmYXVsdDogJ3t9JwogICAgICB0eXBlOiBzdHJpbmcKICAgICAgZGlz\
cGxheV90eXBlOiB0ZXh0YXJlYQogICAgICB0aXRsZTogU2VydmljZSBKU09OIENvbmZpZ3VyYXRp\
b24KICAgICAgcmVxdWlyZWQ6IEZhbHNlCiAgICBiaW5kX3BhcmFtZXRlcnM6CiAgICAtIG5hbWU6\
IENMSUVOVF9JRAogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0bGU6IE1vYmlsZSBDbGllbnQg\
SUQKICAgICAgcmVxdWlyZWQ6IFRydWUK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars  /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
