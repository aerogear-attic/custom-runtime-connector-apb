FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGN1c3RvbS1ydW50aW1lLWNvbm5lY3Rvci1hcGIKZGVzY3JpcHRp\
b246IFJ1bnRpbWUgQ29ubmVjdG9yCmJpbmRhYmxlOiBUcnVlCmFzeW5jOiByZXF1aXJlZAp0YWdz\
OgogIC0gbW9iaWxlLXNlcnZpY2UKICAtIG1vYmlsZS1jbGllbnQtZW5hYmxlZAptZXRhZGF0YToK\
ICBjb25zb2xlLm9wZW5zaGlmdC5pby9pY29uQ2xhc3M6IGZhIGZhLXBsdWcKICBkaXNwbGF5TmFt\
ZTogUnVudGltZSBDb25uZWN0b3IKICBkZXBlbmRlbmNpZXM6IFtdCiAgZG9jdW1lbnRhdGlvblVy\
bDogImh0dHA6Ly93d3cuYWVyb2dlYXIub3JnL2V4dGVybmFsL2FwYi9jdXN0b20tcnVudGltZS1j\
b25uZWN0b3IuaHRtbCIKICBwcm92aWRlckRpc3BsYXlOYW1lOiAiUmVkIEhhdCwgSW5jLiIKICBz\
ZGstZG9jcy1hbmRyb2lkOiAiaHR0cHM6Ly9kb2NzLmFlcm9nZWFyLm9yZyIKICBzZGstZG9jcy1j\
b3Jkb3ZhOiAiaHR0cHM6Ly9kb2NzLmFlcm9nZWFyLm9yZyIKICBzZGstZG9jcy1pb3M6ICJodHRw\
czovL2RvY3MuYWVyb2dlYXIub3JnIgogIHNkay1kb2NzLXhhbWFyaW46ICJodHRwczovL2RvY3Mu\
YWVyb2dlYXIub3JnIgogIHNlcnZpY2VOYW1lOiBjdXN0b20tcnVudGltZS1jb25uZWN0b3IKcGxh\
bnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogVGhpcyBkZWZhdWx0IHBsYW4g\
ZGVwbG95cyBjdXN0b20tcnVudGltZS1jb25uZWN0b3ItYXBiCiAgICBmcmVlOiBUcnVlCiAgICBt\
ZXRhZGF0YToKICAgICAgbW9iaWxlY2xpZW50X2JpbmRfcGFyYW1ldGVyc19kYXRhOgogICAgICAg\
IC0gJ3sibmFtZSI6ICJDTElFTlRfSUQiLCAidmFsdWUiOiAibWV0YWRhdGEubmFtZSIsICJ0eXBl\
IjogInBhdGgifScKICAgIHBhcmFtZXRlcnM6CiAgICAtIG5hbWU6IFNFUlZJQ0VfTkFNRQogICAg\
ICB0eXBlOiBzdHJpbmcKICAgICAgdGl0bGU6IFNlcnZpY2UgTmFtZQogICAgICByZXF1aXJlZDog\
VHJ1ZQogICAgLSBuYW1lOiBTRVJWSUNFX1VSSQogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0\
bGU6IFNlcnZpY2UgVVJMCiAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAtIG5hbWU6IFNFUlZJQ0Vf\
Q09ORklHCiAgICAgIGRlZmF1bHQ6ICd7fScKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIGRpc3Bs\
YXlfdHlwZTogdGV4dGFyZWEKICAgICAgdGl0bGU6IFNlcnZpY2UgSlNPTiBDb25maWd1cmF0aW9u\
CiAgICAgIHJlcXVpcmVkOiBGYWxzZQogICAgYmluZF9wYXJhbWV0ZXJzOgogICAgLSBuYW1lOiBD\
TElFTlRfSUQKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiBNb2JpbGUgQ2xpZW50IElE\
CiAgICAgIHJlcXVpcmVkOiBUcnVlCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars  /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
